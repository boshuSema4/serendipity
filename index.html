<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Serendipity Web</title>
	<link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet">
	<link href="static/web_gui.css" rel="stylesheet">
	<link href="static/introjs.css" rel="stylesheet">
    <link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
    <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>

    <script src="static/reportPage.js"></script>
    <script src="https://d3js.org/d3.v3.min.js"></script>
    <script src="static/FuzzySearch.min.js"></script>
	<script src="static/intro.js"></script>

</head>
<body>
	<header>
		<div class="header">
			<div class="title">
				<h1>Serendipity</h1>
				<h2>A Machine-Learning Application for Mining Serendipitous Drug Usage from Social Media</h2>
			</div>
		</div>
	</header>
	<div class="container">
		<h2>Serendipity is a web application for analyzing serendipitous drug usages mentioned by patients in social media and other patient generated health data</h2>
		<div class="disclaimer">
			<p class="copyright"><details><summary>This prototype application was developped by Boshu Ru<sup>1</sup> and Yueqi Hu<sup>2</sup>, under the advisory of Lixia Yao<sup>3*</sup>.<br>
				The access for this prototype is restricted to reviewers and editors of designated journal and conference and for evaluation use only.<br>
				All rights reserved (2014-2019)</summary>
				<sup>1</sup>Department of Software and Information Systems and
				<sup>2</sup>Department of Computer Science<br>The University of North Carolina at Charlotte, Charlotte, NC<br>
				<sup>3</sup>Department of Health Sciences Research, Mayo Clinic, Rochester, MN <br>
				<sup>*</sup>Contact of the corresponding author: Yao.Lixia@mayo.edu <br>
				</details></p>
		</div>
		<div class="separating_line"></div>
		<div class="form_parts">
			<div class="top" id="user_text" data-step="1" data-intro="Copy social media drug reviews and paste here" data-position="right">
				<h3><span class="steps">Step 1:</span><br/>Enter social media comments</h3>
				<form id="user_input" action = "http://35.207.18.97:5000/gui" method = "POST">
					<p><textarea name="user_text" placeholder=""></textarea></p>
				</form>
			</div>
			<div class="second">
				<div class="second-left" >
					<h3><span class="steps">Step 2:</span><br/>Select the drug associated with these comments</h3>
				</div>
                <div class="second-right" data-step="2"
					 data-intro="Type the name of drug associated with this social media comment. The auto-completion function will list
					 up to 6 drugs in our drug information system.\n Select the best matched drug name from the drop down list.
					 " data-position="Top">
					<div id="input_wrap">
						<input id="drug_select_display" placeholder="Enter part of the drug name to start" >
						<input id="drug_select" style="display: none" form="user_input" name="drug_id" >
					</div>
                </div>
            </div>
			<div class="bottom" >
				<h3><span class="steps">Step 3:</span><br/>Start serendipity analysis</h3>
				<div class="buttons">
                    <input id="reset_but" type="submit" value="Reset"  onclick="resetForm()"/>
                    <input id="sub_but" type="submit" value="Go" form="user_input" data-step="3" data-intro="Submit the social media comments and drug for serendipitous usage analysis." data-position="right"/>
                </div>
			</div>
		</div>
	</div>

    <script>
    $(document).ready(function(){
        $(".third h3").click(function(){
            $(".third_hidden").slideToggle();
        });
    });

    d3.csv("static/drug_id_map.csv", function(d){
        var fuzzyhound = new FuzzySearch({
            output_limit: 6,
            keys:"label",
            source: d
        });

        $('#drug_select_display').autocomplete({
            appendTo: "#input_wrap",
            source: function (request, response) {
                response(fuzzyhound.search(request.term));
            },
            delay: 0,
            minLength: 2,
            focus: function( event, ui ) {
                $( "#drug_select_display" ).val( ui.item.label );
                return false;
            },
            select: function( event, ui ) {
                $( "#drug_select_display" ).val( ui.item.label );
                $( "#drug_select" ).val( ui.item.value );
                return false;
            }
        })
    });

    </script>
	<script type="text/javascript">
         introJs().start();
	</script>
</body>
</html>
